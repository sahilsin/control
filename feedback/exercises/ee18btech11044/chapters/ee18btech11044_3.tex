\begin{enumerate}[label=\arabic*.,ref=\theenumi]
%\begin{enumerate}[label=\thesubsection.\arabic*.,ref=\thesubsection.\theenumi]
\numberwithin{equation}{enumi}

\item  For the Wein-bridge oscillator of Fig \ref{fig:ee18btech11044_3_tikz_1}, use the expression for loop gain to find the poles of the closed-loop system. Give the expression for the pole, Q and use it to show that to locate the poles in the right half of s plane, $\frac{R_2}{R_1}$ must be selected to be greater than 2. 
\renewcommand{\thefigure}{\theenumi.\arabic{figure}}
\begin{figure}[!hbt]
	\begin{center}
			\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11044/ee18btech11044_3_tikz_1.tex}}
	\end{center}
\caption{}
\label{fig:ee18btech11044_3_tikz_1}
\end{figure}



\item Compare the basic structure for a sinusoidal oscillator with Wein-bridge oscillator and give expressions for G and H. 

\solution
\begin{itemize}
 Comparring Fig \ref{fig:ee18btech11044_3_tikz_1} and Fig \ref{fig:ee18btech11044_3_tikz_2}, we get
\begin{align}
G = 1+\frac{R_2}{R_1} \label{eq:ee18btech11044_3_1}\\
H = \frac{Z_p}{Z_p + Z_s}  \label{eq:ee18btech11044_3_2}
\end{align}
where,
\begin{align}
    Z_p = \frac{R}{RSC+1} \\
    Z_s = \frac{RSC+1}{SC}
\end{align}
\end{itemize}



\begin{figure}[!hbt]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11044/ee18btech11044_3_tikz_2.tex}}
	\end{center}
\caption{}
\label{fig:ee18btech11044_3_tikz_2}
\end{figure} 


\item Write the closed loop Transfer function T(s) for wein-bridge oscillator.

\solution
\begin{align}
T(s) = \frac{(1+\frac{R_2}{R_1}) R^2C^2s^2+3RCs+1 }{R^C^2s^2+(2-\frac{R_2}{R_1})RCs+1} \label{eq:ee18btech11044_3_7}
\end{align}





\item Write the characteristic equation for Wein-bridge oscillator.

\solution
\begin{align}
    1 - L(s) = 0  \\
    1 - \frac{1 + \frac{R_2}{R_1}}{3 + sCR + \frac{1}{sCR}} = 0  \\
    3 + sRC + \frac{1}{sCR} = 1 + \frac{R_2}{R_1}  \\
    3 - 1 +sRC +\frac{1}{sRC} -\frac{R_2}{R_1} = 0  \\
    2s + s^2 RC + \frac{1}{RC} -s\frac{R_2}{R_1} = 0  \\
    s^2 RC + s(2 - \frac{R_2}{R_1}) + \frac{1}{RC} =0 \\
    s^2 + s \frac{1}{RC}(2-\frac{R_2}{R_1}) + \frac{1}{R^2C^2} = 0 \label{eq:ee18btech11044_3_3}
\end{align}

\item
Write the general expression for the characteristic equation.

\solution
\begin{align}
    s^2 + s\frac{\omega_0}{Q} + \omega_0^2 = 0 \label{eq:ee18btech11044_3_4}
\end{align}

\item State the \textbf{Barkhausen criterion} for sustained oscillations with frequency $\omega_0$.

\solution
\begin{align}
    L(j\omega_0) = G(j\omega_0)  H(j\omega_0) = 1
\end{align}
\begin{itemize}
    \item That is, at $\omega_0$ the phase of the loop gain should be zero and the magnitude of loop gain should be 1.
    \item Only for a $\infty$ gain,system will produce a finite output for zero input. 
\end{itemize}

\item Give the definition of \textbf{Quality factor}(Q) and explain its significance.

\solution

\begin{itemize}
    \item It is a parameter of an oscillatory system expressing the relationship between stored energy and energy dissipation.
    \item The "purity" of output sine waves will be a function of the selectivity feedback network.
    \item That is, higher the value of Q for frequency selective network, the less the harmonic content of sine wave produced.
\end{itemize}
 


\item 
Compare the equations \ref{eq:ee18btech11044_3_3} and \ref{eq:ee18btech11044_3_4} and give expressions for Q and $\omega_0$

\solution
\begin{align}
    \omega_0^2 = \frac{1}{R^2C^2} \\
    \omega_0 = \frac{1}{RC} \label{eq:ee18btech11044_3_5} \\
    \frac{\omega_0}{Q} = \frac{1}{RC}(2 - \frac{R_2}{R_1}) \\
    Q = \frac{1}{(2 - \frac{R_2}{R_1})} \label{eq:ee18btech11044_3_6} \\
\end{align}
\item 
Using Eq \ref{eq:ee18btech11044_3_6} calculate the value of $\frac{R_2}{R_1}$ for which poles lie on right hand of s-plane.

\solution 

Poles lie on imaginary axis for $Q = \infty$
\begin{align}
    2 - \frac{R_2}{R_1} = 0 \\
    \frac{R_2}{R_1} = 2
\end{align}
$\therefore$ For poles to lie on right hand side of s-plane
\begin{align}
    \frac{R_2}{R_1} >2
\end{align}


\item
Verify the above theory using a Python code.

\solution

\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_1.py
\end{lstlisting}
\begin{itemize}
    \item This figure shows how the location of poles vary if $\frac{R_2}{R_1}$ is varied for a fixed $\omega_0$.
    \item I have varied $\frac{R_2}{R_1}$ from -10 to 10. 
\end{itemize}

\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_1.eps}
\caption{}
\label{fig:ee18btech11044_3_1}
\end{figure}

\item Choose appropriate values of Resistances and Capacitors to simulate the circuit.

\solution

\begin{table}[!ht]
\centering
\input{./tables/ee18btech11044/ee18btech11044_3_t_1.tex}
\caption{}
\label{table:ee18btech11044_t_1}
\end{table}

Where, according to Fig \ref{fig:ee18btech11044_3_tikz_1}
\begin{align}
    R_p = R_s = R \\
    C_p = C_s = C
\end{align}

%Case-------------------------1

\item Calculate the frequency of sinusoid generated for the values given in table \ref{table:ee18btech11044_t_1}.

\solution

\begin{itemize}
\item Calculating poles of transfer function for $\frac{R_2}{R_1}$= 2.03 using a python script.
\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_1.py
\end{lstlisting}
\item We get the poles as 93.75 + j 6249.2968 and 93.75 - j 6249.2968, which correspond to an exponentially increasing sinusoid of  frequency  995.11Hz. 
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%Python simulation

\item Substituting the values shown in table \ref{table:ee18btech11044_t_1} in the Eq \ref{eq:ee18btech11044_3_7}, Plot the impulse response and step response using a python code.

\solution

\begin{itemize}
\item Refer Fig \ref{fig:ee18btech11044_3_2} for impulse response of transfer function.
\item Code for generating impulse response
\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_2.py
\end{lstlisting}
\item Refer D=Fig \ref{fig:ee18btech11044_3_3} for step response of transfer function.
\item Code for generating step response
\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_3.py
\end{lstlisting}
\item As expected from the poles we are getting an exponentially increasing sinusoid as both impulse response and step response.
\end{itemize}

\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_2.eps}
\caption{}
\label{fig:ee18btech11044_3_2}
\end{figure}

\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_3.eps}
\caption{}
\label{fig:ee18btech11044_3_3}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%Spice simulation

\item Simulate the circuit shown in Fig \ref{fig:ee18btech11044_3_tikz_1} using spice simulators. Substitute the values shown in table \ref{table:ee18btech11044_t_1} and plot the output using a python script.

\solution

\begin{itemize}
\item Refer Fig \ref{fig:ee18btech11044_3_4} for the spice simulation output.  
\item You can find the netlist for the simulated circuit here:
\begin{lstlisting}
spice/ee18btech11044/ee18btech11044_3_1.net
\end{lstlisting}
\item You can find the python script used to generate the output here:
\begin{lstlisting}
spice/ee18btech11044/ee18btech11044_spice_3_1.py
\end{lstlisting}
\end{itemize}

\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_4.eps}
\label{fig:ee18btech11044_3_4}
\caption{}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%Frequency of spice simulation

\item Calculate the frequency of sinusoidal wave using plot generated from simulation.
 
 \solution
 \begin{itemize}
     \item Consider a part of plot generated from simulation shown in the Fig \ref{fig:ee18btech11044_3_5}.
     \item Calculating the Time-period of the sinusoidal wave generated using the two points marked in the Fig \ref{fig:ee18btech11044_3_5}.
     \begin{align}
         T_0 = 0.0856452 - 0.0846361 \\
         f_0 = 1/T_0 \\
         f_0 = 990.98Hz.
     \end{align}
     \item We get the frequencies calculated from the formulae and the plot to be approximately same.
     \item Use this script to generate Fig \ref{fig:ee18btech11044_3_5}
\begin{lstlisting}
spice/ee18btech11044/ee18btech11044_spice_3_2.py
\end{lstlisting}
 \end{itemize}
 

 
\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_5.eps}
\caption{}
\label{fig:ee18btech11044_3_5}
\end{figure}

%Case------------------------------------------------2
\item Calculate the poles of transfer function when the ratio $\frac{R_2}{R_1}$ is taken to be 2.

\solution

\begin{itemize}
\item Calculating poles of transfer function for $\frac{R_2}{R_1}$= 2 using a python script.
\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_4.py
\end{lstlisting}
\item We get the poles to be purely imaginery +6250j and -6250j, which correspond to a sinusoid of frequency  995.22Hz. 
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%python simulation
\item Substituting the values shown in table \ref{table:ee18btech11044_t_1} in the Eq \ref{eq:ee18btech11044_3_7}, Consider the ratio of $\frac{R_2}{R_1•}$ = 2 and plot the impulse response and step response using a python code.

\solution

\begin{itemize}
\item Refer Fig \ref{fig:ee18btech11044_3_6} for impulse response of transfer function.
\item Code for generating impulse response
\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_5.py
\end{lstlisting}
\item Refer D=Fig \ref{fig:ee18btech11044_3_7} for step response of transfer function.
\item Code for generating step response
\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_6.py
\end{lstlisting}
\item As expected from the poles we are getting pure sinusoid as both impulse response and step response.
\end{itemize}

\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_6.eps}
\caption{}
\label{fig:ee18btech11044_3_6}
\end{figure}

\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_7.eps}
\caption{}
\label{fig:ee18btech11044_3_7}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%spice simulation
\item Simulate the circuit shown in Fig \ref{fig:ee18btech11044_3_tikz_1} using spice simulators. Consider the ratio of $\frac{R_2}{R_1•}$ = 2 and plot the output using a python script.

\solution

\begin{itemize}
\item Refer Fig \ref{fig:ee18btech11044_3_8} for the spice simulation output.  
\item You can find the netlist for the simulated circuit here:
\begin{lstlisting}
spice/ee18btech11044/ee18btech11044_3_2.net
\end{lstlisting}
\item You can find the python script used to generate the output here:
\begin{lstlisting}
spice/ee18btech11044/ee18btech11044_spice_3_3.py
\end{lstlisting}
\end{itemize}

\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_8.eps}
\label{fig:ee18btech11044_3_8}
\caption{}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%Frequency of spice simulation

\item Calculate the frequency of sinusoidal wave using plot generated from simulationfor the case where $\frac{R_2}{R_1} =2$.
 
 \solution
 \begin{itemize}
     \item Consider a part of plot generated from simulation shown in the Fig \ref{fig:ee18btech11044_3_9}.
     \item Calculating the Time-period of the sinusoidal wave generated using the two points marked in the Fig \ref{fig:ee18btech11044_3_9}.
     \begin{align}
         T_0 = 0.00227823 - 0.00127016 \\
         f_0 = 1/T_0 \\
         f_0 = 991.9944Hz.
     \end{align}
     \item We get the frequencies calculated from the formulae and the plot to be approximately same.
     \item Use this script to generate Fig \ref{fig:ee18btech11044_3_9}
\begin{lstlisting}
spice/ee18btech11044/ee18btech11044_spice_3_4.py
\end{lstlisting}
 \end{itemize}
 

 
\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_9.eps}
\caption{}
\label{fig:ee18btech11044_3_9}
\end{figure}



%%%%%%%%%%%%%%%%%%%%%%%%%%%Case--------------3
\item Calculate the poles of transfer function when the ratio $\frac{R_2}{R_1}$ is taken to be 9.

\solution

\begin{itemize}
\item Calculating poles of transfer function for $\frac{R_2}{R_1}$= 9 using a python script.
\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_7.py
\end{lstlisting}
\item We get the poles two real and distinct poles at 42838.13728906053  and  911.8627109394729, which correspond to an exponentially increasing function.  
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%python simulation
\item Substituting the values shown in table \ref{table:ee18btech11044_t_1} in the Eq \ref{eq:ee18btech11044_3_7}. Consider the ratio of $\frac{R_2}{R_1•}$ = 9 and plot the impulse response and step response using a python code.

\solution

\begin{itemize}
\item Refer Fig \ref{fig:ee18btech11044_3_10} for impulse response of transfer function.
\item Code for generating impulse response
\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_8.py
\end{lstlisting}
\item Refer D=Fig \ref{fig:ee18btech11044_3_11} for step response of transfer function.
\item Code for generating step response
\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_9.py
\end{lstlisting}
\item As expected from the poles we are getting an exponentially increasing function as both impulse response and step response.
\end{itemize}

\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_10.eps}
\caption{}
\label{fig:ee18btech11044_3_10}
\end{figure}

\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_11.eps}
\caption{}
\label{fig:ee18btech11044_3_11}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%spice simulation
\item Simulate the circuit shown in Fig \ref{fig:ee18btech11044_3_tikz_1} using spice simulators. Consider the ratio of $\frac{R_2}{R_1•}$ = 9 and plot the output using a python script.

\solution

\begin{itemize}
\item Refer Fig \ref{fig:ee18btech11044_3_12} for the spice simulation output.  
\item You can find the netlist for the simulated circuit here:
\begin{lstlisting}
spice/ee18btech11044/ee18btech11044_3_3.net
\end{lstlisting}
\item You can find the python script used to generate the output here:
\begin{lstlisting}
spice/ee18btech11044/ee18btech11044_spice_3_5.py
\end{lstlisting}
\end{itemize}

\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_12.eps}
\label{fig:ee18btech11044_3_12}
\caption{}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%Frequency of spice simulation

\item Calculate the frequency of sinusoidal wave using plot generated from simulationfor the case where $\frac{R_2}{R_1} = 9$.
 
 \solution
 \begin{itemize}
     \item Consider a part of plot generated from simulation shown in the Fig \ref{fig:ee18btech11044_3_13}.
     \item Calculating the Time-period of the sinusoidal wave generated using the two points marked in the Fig \ref{fig:ee18btech11044_3_13}.
     \begin{align}
         T_0 = 0.00453629 - 0.00270161 \\
         f_0 = 1/T_0 \\
         f_0 = 545.054Hz.
     \end{align}
     \item We get the frequencies calculated from the formulae and the plot to be approximately same.
     \item Use this script to generate Fig \ref{fig:ee18btech11044_3_13}
\begin{lstlisting}
spice/ee18btech11044/ee18btech11044_spice_3_6.py
\end{lstlisting}
\item In this case because of the saturation voltage in op-amp we are getting a curve similar to square wave.
 \end{itemize}
 

 
\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11044/ee18btech11044_3_13.eps}
\caption{}
\label{fig:ee18btech11044_3_13}
\end{figure}

\item Describe the output depending upon the nature of poles.

\solution 

\begin{itemize}
\item For purely imaginery poles, we expect a sinusoidal output (As in the case $\frac{R_2}{R_1}$ = 2).
\item For complex conjugate poles, we expect an exponentially increasing sinusoid as the output.(As in the case $2 < \frac{R_2}{R_1} < 4$).
\item For real and distinct poles, we expect an exponential  output.(As in the case $\frac{R_2}{R_1} > 4$).
\item As you can observe behaviour of output generated by python scripts can be explained from the location of poles.
\item In the case of spice simulation, the output is always sinusoidal irrespective of location of poles.
\item Only in the case of marginal stability the output of ngspice seems to be valid.  
\item Do not consider the frequency of impulse response from python plot in case-1, as python is not able to calculate the Inverse laplace completely i have plotted using function signal.impulse(system) which generates a python plot of correct shape but frequency cannot be calculated from this plot.
\item Please find the code to calculate impulse response in Case-1.
\begin{lstlisting}
codes/ee18btech11044/ee18btech11044_3_10.py
\end{lstlisting}

\end{itemize}

\end{enumerate}
